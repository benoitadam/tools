{"mappings":"AEQA,IAAI,EAAoB,WAAW,YAAnC,CDNA,SAAS,SAAU,KACjB,IAAM,EAAc,CAAC,ECQnB,EDNS,CACT,QAAS,AAAC,GAAgB,CAAM,CAAC,EAAI,EAAI,KACzC,WAAY,AAAC,IAAkB,OAAO,CAAM,CAAC,EAAI,AAAE,EACnD,QAAS,CAAC,EAAa,IAAkB,CAAM,CAAC,EAAI,CAAG,CACzD,EAEA,KAAK,QAAS,KACZ,ACSG,CAAA,SAA4B,CAAW,CAAE,CAAQ,EACpD,IAAM,EAAO,AAAU,KAAA,IAAV,EAAsB,ACThC,SAA6B,CAAM,CAAE,CAAa,CAAE,CAAkB,EACzE,GAAI,CACA,OAAO,KAAK,SAAA,CAAU,EAAG,KAAqB,EAClD,CACA,MAAO,EAAO,CACV,MACJ,CACJ,EDE+C,GAAS,KAAA,CAChD,AAAS,MAAA,IAAT,EAAoB,EAAS,UAAA,CAAW,GACvC,EAAS,OAAA,CAAQ,EAAK,EAC/B,CAAA,EDbc,QAAS,OACnB,OAAO,ACGJ,SAA4B,CAAW,CAAE,CAAU,EACtD,IAAM,EAAO,EAAS,OAAA,CAAQ,GAC9B,OAAO,AChBJ,SAAwC,CAAM,CAAE,CAAa,EAChE,GAAI,CACA,OAAO,KAAK,KAAA,CAAM,EACtB,CACA,MAAO,EAAO,CACV,OAAO,CACX,CACJ,EDSqB,EAF2B,KAAA,EAGhD,EDNqB,UAAU,OAAA,CAAQ,MACrC,EACF","sources":["<anon>","src/stored.spec.ts","src/stored.ts","src/json.ts"],"sourcesContent":["function $32904ed98b730a93$export$18c43dcebf00e571(v, defVal) {\n    try {\n        return JSON.parse(v);\n    } catch (error) {\n        return defVal;\n    }\n}\nfunction $32904ed98b730a93$export$a75c676177490cac(v, defVal, indented) {\n    try {\n        return JSON.stringify(v, null, indented ? 2 : 0);\n    } catch (error) {\n        return defVal;\n    }\n}\nfunction $32904ed98b730a93$export$9cd59f9826255e47(v, defVal) {\n    return $32904ed98b730a93$export$18c43dcebf00e571($32904ed98b730a93$export$a75c676177490cac(v), defVal);\n}\n\n\nlet $e7616b57c23a787b$var$_storage = globalThis.localStorage;\nfunction $e7616b57c23a787b$export$825479ec1107c193(storage) {\n    $e7616b57c23a787b$var$_storage = storage;\n}\nfunction $e7616b57c23a787b$export$43b36d76881373cf(key, defVal) {\n    const json = $e7616b57c23a787b$var$_storage.getItem(key);\n    return (0, $32904ed98b730a93$export$18c43dcebf00e571)(json, defVal);\n}\nfunction $e7616b57c23a787b$export$b6f24a8024dbaa15(key, value) {\n    const json = value !== undefined ? (0, $32904ed98b730a93$export$a75c676177490cac)(value) : undefined;\n    if (json === undefined) $e7616b57c23a787b$var$_storage.removeItem(key);\n    else $e7616b57c23a787b$var$_storage.setItem(key, json);\n}\n\n\ndescribe(\"stored\", ()=>{\n    const values = {};\n    (0, $e7616b57c23a787b$export$825479ec1107c193)({\n        getItem: (key)=>values[key] || null,\n        removeItem: (key)=>{\n            delete values[key];\n        },\n        setItem: (key, value)=>values[key] = value\n    });\n    test(`test1`, ()=>{\n        (0, $e7616b57c23a787b$export$b6f24a8024dbaa15)(\"test1\", \"abc\");\n        expect((0, $e7616b57c23a787b$export$43b36d76881373cf)(\"test1\")).toEqual(\"abc\");\n    });\n});\n\n\n//# sourceMappingURL=stored.spec.js.map\n","import { setStorage, getStored, setStored } from './stored';\n\ndescribe('stored', () => {\n  const values: any = {};\n\n  setStorage({\n    getItem: (key: string) => values[key] || null,\n    removeItem: (key: string) => { delete values[key]; },\n    setItem: (key: string, value: string) => values[key] = value,\n  })\n\n  test(`test1`, () => {\n    setStored('test1', 'abc');\n    expect(getStored('test1')).toEqual('abc');\n  });\n});\n\n\n","import { getJson, parseJson } from \"./json\";\n\nexport interface Storage {\n    getItem(key: string): string | null;\n    removeItem(key: string): void;\n    setItem(key: string, value: string): void;\n}\n\nlet _storage: Storage = globalThis.localStorage;\n\nexport function setStorage(storage: Storage) {\n    _storage = storage;\n}\n\nexport function getStored<T = any>(key: string): T | undefined;\nexport function getStored<T = any>(key: string, defVal?: T): T;\nexport function getStored<T = any>(key: string, defVal?: T): T | undefined {\n    const json = _storage.getItem(key);\n    return parseJson(json, defVal);\n}\n\nexport function setStored<T = any>(key: string, value: T) {\n    const json = value !== undefined ? getJson(value) : undefined;\n    if (json === undefined) _storage.removeItem(key);\n    else _storage.setItem(key, json);\n}\n","export function parseJson<T = any>(v: any): T | undefined;\nexport function parseJson<T = any, TDef = any>(v: any, defVal: TDef): T | TDef;\nexport function parseJson<T = any, TDef = any>(v: any, defVal?: TDef): T | TDef | undefined {\n    try {\n        return JSON.parse(v) as T;\n    }\n    catch (error) {\n        return defVal;\n    }\n}\n\nexport function getJson(v: any): string | undefined;\nexport function getJson<TDef = any>(v: any, defVal: TDef, indented?: boolean): string | TDef;\nexport function getJson<TDef = any>(v: any, defVal?: TDef, indented?: boolean): string | TDef | undefined {\n    try {\n        return JSON.stringify(v, null, indented ? 2 : 0);\n    }\n    catch (error) {\n        return defVal;\n    }\n}\n\nexport function clone<T = any>(v: T): T | undefined;\nexport function clone<T = any>(v: T, defVal: T): T;\nexport function clone<T = any>(v: T, defVal?: T): T | undefined {\n    return parseJson(getJson(v), defVal);\n}"],"names":["$e7616b57c23a787b$var$_storage","globalThis","localStorage","describe","values","getItem","key","removeItem","setItem","value","test","json","undefined","v","defVal","indented","JSON","stringify","error","expect","parse","toEqual"],"version":3,"file":"stored.spec.js.map","sourceRoot":"../"}